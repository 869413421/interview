#### Redis 和 memcached 的区别

- redis 支持更加丰富的数据存储类型（string/hash/list/set/sorted set）；memcached 只支持简单的 key-value 结构
- redis 支持简单的事务
- redis 支持数据持久型，可以将内存中的数据保存在磁盘中
    - 持久性：
        - RDB：在一定周期内，将内存中的数据以快照的形式保存到硬盘的二进制文件
        - AOF：redis 将每个收到的写命令都通过 write 函数追加到文件最后，redis 重启会重新执行文件中保存的写命令来在内存中重建整个数据库的内容
- redis 只是单核，memcached 是多核

#### 缓存雪崩/穿透

- 雪崩：当缓存服务器重启或者是大量缓存在同一时间失效，给后台系统带来很大的压力，导致系统崩溃
    - 解决：
        - 当缓存失效时，增加锁来保证某个 key 只有一个线程操作数据库
        - 分散缓存失效时间
        - 做二级缓存
- 穿透：大量请求绕过缓存直接请求数据库
    - 解决
        - 对一定不存在的 key 进行过滤，将可能存在 key 放在一个大的 bitmap 中，查询时过滤
        - 对空值也进行缓存，缓存时间短一点

#### 单线程的 redis 为什么这么快

- 纯内存操作
- 单线程操作，避免了上下文切换
- 采用的非阻塞 I/O 多路复用机制

#### Redis 的数据类型以及每种数据类型的使用场景

- string：最常规的 set/get 操作，一般做一些复杂的技术功能的缓存
- hash：存放结构化的对象
- list：可以做简单的消息队列功能，可以做 redis 分页功能（lrange）
- sort：存储的是不重复的值，适合做全局去重的功能
- sorted set：集合中多了个 score 参数，可以做排行榜应用

#### Redis 的过期策略以及内存淘汰机制

过期策略：

- 定期删除，没一段时间检查是否有过期 key
- 惰性删除，使用时用到这个 key 的时候检查，过期就删除

淘汰机制

- 从已设置过期时间的数据集中挑选最少使用的数据淘汰 -> volatitle-lru
- 从已设置过期时间的数据集中挑选即将过期的数据淘汰 -> volatitle-ttl
- 从已设置过期时间的数据集中任意选择数据淘汰 -> volatitle-random
- 从数据集中挑选最近最少使用的数据淘汰 -> allkeys-lru
- 从数据集中中任意淘汰 allkeys-random
- 禁止驱逐数据，新写入会报错 no-enviction

